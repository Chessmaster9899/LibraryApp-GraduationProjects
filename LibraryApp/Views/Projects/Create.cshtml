@model Project

@{
    ViewData["Title"] = "Create Project";
}

<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <!-- Modern Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h1 class="h2 mb-1 fw-bold text-dark">Create New Project</h1>
                    <p class="text-muted mb-0">Add a new graduation project to the system</p>
                </div>
                <div>
                    <a asp-action="Index" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-1"></i>Back to Projects
                    </a>
                </div>
            </div>

            <!-- Modern Form Card -->
            <div class="card border-0 shadow-lg">
                <div class="card-header bg-white border-bottom">
                    <div class="d-flex align-items-center">
                        <div class="bg-primary bg-opacity-10 rounded-circle p-2 me-3">
                            <i class="fas fa-plus-circle text-primary"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-0 text-dark">Project Information</h5>
                            <small class="text-muted">Fill in the details for the new project</small>
                        </div>
                    </div>
                </div>
                <div class="card-body p-4">
                    <form asp-action="Create" enctype="multipart/form-data" class="needs-validation" novalidate>
                        <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>
                        
                        <div class="row">
                            <!-- Basic Information Section -->
                            <div class="col-lg-8">
                                <h6 class="text-muted mb-3 fw-semibold">
                                    <i class="fas fa-info-circle me-2"></i>Basic Information
                                </h6>
                                
                                <div class="mb-4">
                                    <label asp-for="Title" class="form-label fw-semibold">Project Title <span class="text-danger">*</span></label>
                                    <input asp-for="Title" class="form-control form-control-lg" placeholder="Enter the project title..." required />
                                    <span asp-validation-for="Title" class="text-danger"></span>
                                </div>

                                <div class="mb-4">
                                    <label asp-for="Abstract" class="form-label fw-semibold">Abstract</label>
                                    <textarea asp-for="Abstract" class="form-control" rows="6" 
                                              placeholder="Provide a comprehensive description of the project goals, methodology, and expected outcomes..."></textarea>
                                    <span asp-validation-for="Abstract" class="text-danger"></span>
                                    <div class="form-text">Describe the project's purpose, approach, and significance.</div>
                                </div>

                                <div class="mb-4">
                                    <label asp-for="Keywords" class="form-label fw-semibold">Keywords</label>
                                    <input asp-for="Keywords" class="form-control" 
                                           placeholder="Machine Learning, Database, Web Development, AI" />
                                    <span asp-validation-for="Keywords" class="text-danger"></span>
                                    <div class="form-text">Separate keywords with commas to help categorize the project.</div>
                                </div>
                            </div>

                            <!-- Project Details Section -->
                            <div class="col-lg-4">
                                <h6 class="text-muted mb-3 fw-semibold">
                                    <i class="fas fa-cogs me-2"></i>Project Details
                                </h6>
                                
                                <div class="mb-3">
                                    <label asp-for="Status" class="form-label fw-semibold">Status</label>
                                    <select asp-for="Status" class="form-select" asp-items="Html.GetEnumSelectList<ProjectStatus>()">
                                        <option value="">Select Status</option>
                                    </select>
                                    <span asp-validation-for="Status" class="text-danger"></span>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="SubmissionDate" class="form-label fw-semibold">Submission Date</label>
                                    <input asp-for="SubmissionDate" class="form-control" type="date" 
                                           value="@DateTime.Now.ToString("yyyy-MM-dd")" />
                                    <span asp-validation-for="SubmissionDate" class="text-danger"></span>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="Status" class="form-label fw-semibold">Status</label>
                                    <select asp-for="Status" class="form-select" asp-items="Html.GetEnumSelectList<ProjectStatus>()">
                                        <option value="">Select Status</option>
                                    </select>
                                    <span asp-validation-for="Status" class="text-danger"></span>
                                    <div class="form-text">Project workflow status</div>
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <!-- Participants Section -->
                        <div class="row">
                            <div class="col-12">
                                <h6 class="text-muted mb-3 fw-semibold">
                                    <i class="fas fa-users me-2"></i>Project Participants
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Students <span class="text-danger">*</span></label>
                                    <div class="form-text mb-2">Select 1-3 students for this project</div>
                                    <select id="studentSelect" class="form-select" multiple style="height: 120px;">
                                        @if (ViewBag.StudentId != null)
                                        {
                                            @foreach (var student in (SelectList)ViewBag.StudentId)
                                            {
                                                <option value="@student.Value">@student.Text</option>
                                            }
                                        }
                                    </select>
                                    <div class="form-text">Hold Ctrl/Cmd to select multiple students</div>
                                    <input type="hidden" id="selectedStudents" name="SelectedStudentIds" />
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label asp-for="SupervisorId" class="form-label fw-semibold">Supervisor <span class="text-danger">*</span></label>
                                    <select asp-for="SupervisorId" class="form-select" asp-items="ViewBag.SupervisorId" required>
                                        <option value="">Select Supervisor</option>
                                    </select>
                                    <span asp-validation-for="SupervisorId" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label asp-for="EvaluatorId" class="form-label fw-semibold">Evaluator</label>
                                    <select asp-for="EvaluatorId" class="form-select" asp-items="ViewBag.EvaluatorId">
                                        <option value="">Select Evaluator</option>
                                    </select>
                                    <span asp-validation-for="EvaluatorId" class="text-danger"></span>
                                    <div class="form-text">Optional - can be assigned later</div>
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <!-- File Upload Section -->
                        <div class="row">
                            <div class="col-12">
                                <h6 class="text-muted mb-3 fw-semibold">
                                    <i class="fas fa-file-upload me-2"></i>Project Files
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Project Document</label>
                                    <input type="file" name="documentFile" class="form-control" accept=".pdf,.doc,.docx,.txt" />
                                    <div class="form-text">Accepted formats: PDF, DOC, DOCX, TXT (Max 50MB)</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Project Poster</label>
                                    <input type="file" name="posterFile" class="form-control" accept=".jpg,.jpeg,.png,.gif,.pdf" />
                                    <div class="form-text">Accepted formats: JPG, PNG, GIF, PDF (Max 20MB)</div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="mt-4 pt-3 border-top">
                            <div class="d-flex gap-2 justify-content-end">
                                <a asp-action="Index" class="btn btn-outline-secondary btn-lg">
                                    <i class="fas fa-times me-1"></i>Cancel
                                </a>
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-save me-1"></i>Create Project
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    border-radius: 16px;
}

.card-header {
    border-radius: 16px 16px 0 0 !important;
    padding: 1.5rem;
}

.form-control, .form-select {
    border-radius: 12px;
    border: 2px solid #e5e7eb;
    padding: 0.75rem 1rem;
    transition: all 0.3s ease;
}

.form-control:focus, .form-select:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    transform: translateY(-1px);
}

.form-control-lg {
    font-size: 1.1rem;
    padding: 1rem 1.25rem;
}

.btn-lg {
    padding: 0.875rem 2rem;
    border-radius: 12px;
    font-weight: 600;
}

.form-text {
    font-size: 0.875rem;
    color: #6b7280;
    margin-top: 0.5rem;
}

.text-danger {
    font-size: 0.875rem;
    font-weight: 500;
}

hr {
    border-color: #e5e7eb;
    margin: 2rem 0;
}

h6.text-muted {
    color: #374151 !important;
    font-size: 0.95rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}
</style>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        // Handle multiple student selection
        document.getElementById('studentSelect').addEventListener('change', function() {
            const selectedOptions = Array.from(this.selectedOptions);
            const selectedIds = selectedOptions.map(option => option.value);
            
            // Limit to 3 students maximum
            if (selectedIds.length > 3) {
                // Deselect the last selected option
                this.selectedOptions[this.selectedOptions.length - 1].selected = false;
                selectedIds.pop();
                alert('Maximum 3 students allowed per project');
            }
            
            // Update hidden field
            document.getElementById('selectedStudents').value = selectedIds.join(',');
        });
    </script>
}